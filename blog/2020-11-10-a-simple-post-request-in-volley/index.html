<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><meta name="generator" content="Gatsby 4.4.0"/><style data-emotion="css-global o6gwfi">html{-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;box-sizing:border-box;-webkit-text-size-adjust:100%;}*,*::before,*::after{box-sizing:inherit;}strong,b{font-weight:700;}body{margin:0;color:rgba(0, 0, 0, 0.87);font-family:"Roboto","Helvetica","Arial",sans-serif;font-weight:400;font-size:1rem;line-height:1.5;letter-spacing:0.00938em;background-color:#fff;}@media print{body{background-color:#fff;}}body::backdrop{background-color:#fff;}</style><style data-emotion="css 1qsxih2">.css-1qsxih2{width:100%;margin-left:auto;box-sizing:border-box;margin-right:auto;display:block;padding-left:16px;padding-right:16px;}@media (min-width:600px){.css-1qsxih2{padding-left:24px;padding-right:24px;}}@media (min-width:1200px){.css-1qsxih2{max-width:1200px;}}</style><title data-react-helmet="true"></title><link data-react-helmet="true" href="https://fonts.googleapis.com/css?family=Roboto:400,500,700&amp;display=swap" rel="stylesheet"/><meta data-react-helmet="true" name="viewport" content="initial-scale=1, width=device-width"/><style>.gatsby-image-wrapper{position:relative;overflow:hidden}.gatsby-image-wrapper picture.object-fit-polyfill{position:static!important}.gatsby-image-wrapper img{bottom:0;height:100%;left:0;margin:0;max-width:none;padding:0;position:absolute;right:0;top:0;width:100%;object-fit:cover}.gatsby-image-wrapper [data-main-image]{opacity:0;transform:translateZ(0);transition:opacity .25s linear;will-change:opacity}.gatsby-image-wrapper-constrained{display:inline-block;vertical-align:top}</style><noscript><style>.gatsby-image-wrapper noscript [data-main-image]{opacity:1!important}.gatsby-image-wrapper [data-placeholder-image]{opacity:0!important}</style></noscript><script type="module">const e="undefined"!=typeof HTMLImageElement&&"loading"in HTMLImageElement.prototype;e&&document.body.addEventListener("load",(function(e){if(void 0===e.target.dataset.mainImage)return;if(void 0===e.target.dataset.gatsbyImageSsr)return;const t=e.target;let a=null,n=t;for(;null===a&&n;)void 0!==n.parentNode.dataset.gatsbyImageWrapper&&(a=n.parentNode),n=n.parentNode;const o=a.querySelector("[data-placeholder-image]"),r=new Image;r.src=t.currentSrc,r.decode().catch((()=>{})).then((()=>{t.style.opacity=1,o&&(o.style.opacity=0,o.style.transition="opacity 500ms linear")}))}),!0);</script><link as="script" rel="preload" href="/webpack-runtime-50e0d37378e5e962947b.js"/><link as="script" rel="preload" href="/framework-d6d5e2b89c78b2abaef7.js"/><link as="script" rel="preload" href="/app-7d2eeea4c5090ac1194c.js"/><link as="script" rel="preload" href="/117fb336e4bc1ede79596e75b5ae5d2880838c24-d492c486524e64467702.js"/><link as="script" rel="preload" href="/component---src-pages-blog-mdx-slug-js-52a611415d615843b3a6.js"/><link as="fetch" rel="preload" href="/page-data/blog/2020-11-10-a-simple-post-request-in-volley/page-data.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/app-data.json" crossorigin="anonymous"/></head><body><div id="___gatsby"><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><div><title>A simple post in Volley</title><main><h1>A simple post in Volley</h1><div class="MuiContainer-root MuiContainer-maxWidthLg css-1qsxih2"><p>November 10, 2020</p><p>This is a continuation to my series on Volley. If you read my previous posts (<a href="https://woodsmanlucas.github.io/android/volley/android-studio/kotlin/2020/11/07/Getting-Started-with-Volley.html">the first</a> and <a href="https://woodsmanlucas.github.io/2020/11/09/Volley-a-simple-get-request.html">the second</a>) hopefully you are starting to get a grasp of how Volley works. Maybe you even did some side reading in the official documentation and have a great understanding. And maybe if I&#x27;m lucky you even noticed that in the get request we specify the method in the String request:</p><pre><code class="language-kotlin">    val stringRequest = StringRequest(Request.Method.GET, url, ...
</code></pre><p>So this post is going to be about how to make a post request so lets change that right now to this:</p><pre><code class="language-kotlin">    val stringRequest = StringRequest(Request.Method.POST, url, ... 
</code></pre><p>I also went ahead and changed the url to that of my site <a href="https://sonarmusic.social">sonarmusic.social</a> but, you can use any post link:</p><pre><code class="language-kotlin">    val url = &quot;https://www.sonarmusic.social/api/auth/register&quot;
</code></pre><p>Next I added the json body just below the url:</p><pre><code class="language-kotlin">    val url = &quot;https://www.google.com&quot;
    val jsonBody = JSONObject()
    jsonBody.put(&quot;email&quot;, &quot;lucas@sonarmusic.social&quot;)
    jsonBody.put(&quot;username&quot;, &quot;Lucas&quot;)
    jsonBody.put(&quot;firstName&quot;, &quot;Lucas&quot;)
    jsonBody.put(&quot;lastName&quot;, &quot;Johnson&quot;)
    jsonBody.put(&quot;password&quot;, &quot;P@ssw0rd&quot;)
    jsonBody.put(&quot;userType&quot;, &quot;user&quot;)
    val requestBody = jsonBody.toString()
</code></pre><p>Now in order to override the functions within the string request and add in the body to the function we have to declare the string request as an object:</p><pre><code class="language-kotlin">    val stringRequest = object : StringRequest(Request.Method.POST, url, ...
</code></pre><p>Then lets override the functions and add in a body!</p><pre><code class="language-kotlin">    val stringRequest = object : StringRequest(Request.Method.POST, url, ...) {
            override fun getBodyContentType(): String {
                return &quot;application/json&quot;
            }
            @Throws(AuthFailureError::class)
            override fun getBody(): ByteArray {
                return requestBody.toByteArray()
            }
    }
</code></pre><p>Notice that I added a content type to the request as well. Now let&#x27;s run this and see if it works.</p><p><img src="/assets/2020-11-10-SimplePost/FirstTry.png" alt="My First Try didn&#x27;t work..."/></p><p>Now its kind of hard to read but it says &quot;That didn&#x27;t work&quot;. I guess we are hitting our error statement. Notice it also says &quot;Unexpected response code 400&quot;. We all know what that means... Bad Data. Let&#x27;s see if we can add in a couple more lines and get to the bottom of this.</p><pre><code class="language-kotlin">Response.ErrorListener { error -&gt;
val responseBody = String(error.networkResponse.data, UTF_8)
println(responseBody)
})
</code></pre><p>Again we will have to hit alt-Enter on this UTF_8 to import the character type. Now lets run again and see what happens:</p><p><img src="/assets/2020-11-10-SimplePost/TryingAgainWithErrors.png" alt="Now we can see what is going on"/></p><p>Oh boy, looks like my email already exists! Let&#x27;s try again with a different email. If your not a musician and aren&#x27;t planning on using sonar please login and delete your account once you are done. And on that note of spectacular failure I&#x27;m going to leave you to get your post running as an exercise. If you have any problems you can tweet me and I will try to get back to you as soon as reasonably possible.</p></div></main></div></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/blog/2020-11-10-a-simple-post-request-in-volley/";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"polyfill":["/polyfill-bb53d728883c387f23a4.js"],"app":["/app-7d2eeea4c5090ac1194c.js"],"component---src-pages-404-js":["/component---src-pages-404-js-4cadfaafd24a7cb04fe5.js"],"component---src-pages-blog-mdx-slug-js":["/component---src-pages-blog-mdx-slug-js-52a611415d615843b3a6.js"],"component---src-pages-index-js":["/component---src-pages-index-js-4aa6d4b2d3ec3dc028d0.js"],"component---src-pages-tech-js":["/component---src-pages-tech-js-1bbfeea0cfbe7e9ad0b6.js"],"component---src-pages-travel-js":["/component---src-pages-travel-js-78f4a18dcd47e15365af.js"]};/*]]>*/</script><script src="/polyfill-bb53d728883c387f23a4.js" nomodule=""></script><script src="/component---src-pages-blog-mdx-slug-js-52a611415d615843b3a6.js" async=""></script><script src="/117fb336e4bc1ede79596e75b5ae5d2880838c24-d492c486524e64467702.js" async=""></script><script src="/app-7d2eeea4c5090ac1194c.js" async=""></script><script src="/framework-d6d5e2b89c78b2abaef7.js" async=""></script><script src="/webpack-runtime-50e0d37378e5e962947b.js" async=""></script></body></html>